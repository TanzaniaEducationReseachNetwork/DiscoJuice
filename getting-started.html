---
layout: default
title: Getting started
slug: getting-started
lead: "An overview of DiscoJuice, how to integrate with your Service Provider."
base_url: "../"
---


	<!-- Getting started
	================================================== -->
	<div class="bs-docs-section">
		<div class="page-header">
			<h1 id="whatis">Getting started with DiscoJuice</h1>
		</div>
		<p class="lead">DiscoJuice is a very flexible User Interface library for implementing an IdP Discovery Service.</p>



		<div class="bs-callout bs-callout-danger" id="callout-less-compilation">

			<h4>Important warning on using DiscoJuice in production!</h4>

			<p>As of April 2014 DiscoJuice is not <i>yet</i> established in a production ready environment. There is a huge interest in DiscoJuice and we use it ourself as well, and we are looking into the possibilities of establishing DiscoJuice in a very reliable hosting serivce. </p>

			<p>If you have input with regards to requirements, ideas or suggestions with regards to using DiscoJuice, you may <a href="mailto:andreas.solberg@uninett.no">contact Andreas directly</a>.</p>

			<p>Stay tuned, and join the mailinglist!</p>
			
		</div>


		<h3>What is DiscoJuice</h3>

		<p>As a service provider, connected to a large number of Identity Providers, you would need to ask the user in advance of the authentication process to select its Identity Provider.</p>

		<p>DiscoJuice is super simple to deploy at a Service Provider. Is is as easy as copy and pasting a small javascript refernece into the HTML source of your application.</p>



		<h3>Features</h3>

		<p>Some of the features DiscoJuice supports includes:</p>

		<ul>
			<li>Local Memory (cookie)</li>
			<li>Remote Memory (DiscoReadWrite protocol + IdP Discovery)</li>
			<li>Javascript only, super simple to deploy</li>
			<li>DiscoJuiceJSON compact UI-focused Metadata format (MDUI friendly)</li>
			<li>Presents logos, searchable keywords, name, descr, country...</li>
			<li>Automatically discovery of country </li>
			<li>HTML5 Geo-location API</li>
			<li>Gracefull non-javascript fallback</li>
			<li>Inline incremental search </li>
			<li>Flexible integration API using JS callbacks.</li>
			<li>Protocol agnostics, demoed with alternative protocols.</li>
			<li>Multi-lingual both provider list (from metadata) and UI is translated into 15 languages</li>
		</ul>



		<h3>Deployment options</h3>

		<p>There are at least three ways to deploy DiscoJuice that you should be aware of.</p>

		<ol>
			<li><a href="#deploy-embedded">DiscoJuice embedded IdP Selector Popup in Application</a></li>
			<li><a href="#deploy-sp">Service Provider IdP Discovery Service</a></li>
			<li><a href="#deploy-federation">Identity Federation Central IdP Discovery Service</a></li>
			<li><a href="#deploy-global">Global IdP Discovery Service</a></li>
		</ol>


	</div>



	<div class="bs-docs-section">
		<div class="page-header">
			<h1 id="deploy-embedded">Embedded DiscoJuice</h1>
		</div>
		<p class="lead">If your application has a login-button, this button can be connected to the Embedded DiscoJuice Discovery Service.</p>

		<p><img class="img-responsive img-thumbnail" 
			src="{{ page.base_url }}assets/discojuice-screenshot-embed.png" 
			alt="Screenshot of DiscoJuice embedded" /></p>

		<p>By installing DiscoJuice, the login button will result in a DiscoJuice popup discovery service that allows the user to select Identity Provider, and then redirects the user in the correct way.</p>

		<p>Prepare to add some HTML template of the pages where you would connect DiscoJuice to the login button. You probably will have a login link or button similar to this:</p>

{% highlight html %}
<a href="/login" class="login-btn">Login</a>
{% endhighlight %}


		<p>Next, in the <code>&lt;head&gt;</code>-section of your HTML page you will need to setup DiscoJuice.</p>


{% highlight html %}
<!-- JQuery hosted by Google -->
<script src="//ajax.googleapis.com/ajax/libs/jquery/1.10.2/jquery.min.js" type="text/javascript"></script>

<!-- DiscoJuice hosted by UNINETT at discojuice.org -->
<script type="text/javascript" src="https://cdn.discojuice.org/discojuice-stable.min.js"></script>
<link rel="stylesheet" type="text/css" href="https://cdn.discojuice.org/css/discojuice.css" />
<script type="text/javascript">
	DiscoJuice.Hosted.setup(
		{
			"target": "a.signin",
			"title": "Example showcase service",
			"spentityid": "https://bridge.uninett.no/saml2/entityid",
			"responseurl": "http://bridge.uninett.no/response.html",
			"redirectURL": "http://bridge.uninett.no/login?idp=",
			"feeds": ["edugain", "kalmar", "feide"]
		}
	);
</script>
{% endhighlight %}

		<p>Notice that if you already have jQuery referenced on your site, DiscoJuice may reuse this jQuery, and you should not refer jQuery twice. DiscoJuice does not require any specific version of jQuery.</p>


		<p>The <code>DiscoJuice.Hosted.setup()</code> function takes a configuration object as a parameter. The configuration object, may contain the following properties:</p>



		<dl class="dl-horizontal">

			<dt><code>target</code> </dt>
			<dd>
				<p><span class="label label-primary">Optional</span> The <a href="http://api.jquery.com/category/selectors/">JQuery selector</a>, pointing to the login button discussed above. In example <code>a.login-btn</code> will refer to a login link like this: <code>&lt;a href="" class="login-btn"&gt;Login&lt;/a&gt;</code>.</p>
				<p>If you leave out this parameter, it does attach to "body" instead, and will open on page load instead of being invoked by a button click.</p>
			</dd>


			<dt><code>title</code> </dt>
			<dd><span class="label label-primary">Optional</span> The name of the service. Using the header of the DiscoJuice popup.</dd>

			<dt><code>feeds</code></dt>
			<dd><span class="label label-danger">Required</span> A list of metadata feeds that you would like to use. A metadata feed is basically a list of providers with additional metadata, like keywords and logos. <a target="_blank" href="http://cdn.discojuice.org/feeds/">See a list of available metadata feeds</a></dd>


			<dt><code>redirectURL</code></dt>
			<dd><span class="label label-danger">Required</span> A URL prefix that the user will be redirected to after the user has selected a provider. The user will then be redirected to this URL but with the identifier of the provider added as a suffix.</dd>
			

			<dt><code>spentityid</code></dt>
			<dd><span class="label label-warning">Reccomended</span> 
				The Service Provider EntityID, used in the IdP Discovery Protocol.</dd>


			<dt><code>responseurl</code></dt>
			<dd><span class="label label-warning">Reccomended</span> The <em>IdP Discovery Response URL</em>, point to <a href="#settingup-responsepage">a special HTML page that you need to host on your site; more on this below</a>.</dd>

		</dl>

		<p>The two properties <code>spentityid</code> and <code>responseurl</code> is required in order to enable the central IdP Discovery protocol that allows users of the </p>





		<div class="bs-callout bs-callout-warning" id="callout-less-compilation">
			<h4>Protected pages without a login button</h4>
			<p>If your application includes pages that would require immediate redirect to the identity provider, there is no login button to connect to DiscoJuice. Instead you can combine these protected pages to any of the standalone DiscoJuice discovery options:</p>

			<ul>
				<li><a href="#deploy-sp">Service Provider IdP Discovery Service</a></li>
				<li><a href="#deploy-global">Global IdP Discovery Service</a></li>
			</ul>

		</div>


		<h2 id="settingup-responsepage">Setting up the IdP Discovery Response HTML page</h2>

		<p>There is a static HTML page that you need to setup on your own host, and you need to configure the URL of this page</p>


		<p>The <em>IdP Discovery Response page</em> is a simple HTML page that you should install on your service provider. You can <a href="https://raw.github.com/andreassolberg/DiscoJuice/master/discojuice/discojuiceDiscoveryResponse.html">download this file here</a>.</p>

		<p>The URL to this response page is required in the configuration above. It must be hosted on your own server, to fulfil the same-origin policy.</p>




		<h3>Beeing a trusted client</h3>

		<p>DiscoJuice.org hosts a <em>passice central discovery service</em>, and to get this to work, your hostname needs to be trusted by DiscoJuice.org. If your metadata cotains a <code>DiscoveryResponse</code> element, and is present in eduGAIN, InCommon, Kalmar or UK Access Federation, it should be trusted already. If you want to add additional hosts without joining these federations, ask on the <a href="{{ page.base_url }}community/">DiscoJuice mailinglist</a>.</p>



	</div>




	<div class="bs-docs-section">
		<div class="page-header">
			<h1 id="deploy-sp">Service Provider Discovery</h1>
		</div>
		<p class="lead">Setup a preconfigured discovery service for your local Service Provider that implements the IdP Discovery Protocol.</p>

		<p>Setting up a discovery service using DiscoJuice typically involves two main steps:</p>
		<ol>
			<li>Configure an ACL list of hostnames that are allowed to communicate and get respones from the Discovery Service</li>
			<li>Setup the discovery page it self containing static HTML</li>
		</ol>


		<h2>Setting up the HTML Discovery page</h2>

		<p>The page will be presented on a URL of your choice. This URL will be the endpoint where you point the service provider to send IdP Discovery requsts.</p>

		<p>Below is an example of such a page.</p>


{% highlight html %}
<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="utf-8" />
	<title>Select your login provider â€“ DiscoJuice</title>
	
	<script type="text/javascript" 
		src="//ajax.googleapis.com/ajax/libs/jquery/1.10.2/jquery.min.js"></script>

	<script type="text/javascript" language="javascript" 
		src="//cdn.discojuice.org/engine/discojuice-stable.min.js"></script>
	<script type="text/javascript" language="javascript" 
		src="//cdn.discojuice.org/engine/idpdiscovery.js"></script>

	<link rel="stylesheet" type="text/css" 
		href="//cdn.discojuice.org/css/discojuice.css" />


	<style type="text/css">
		body {
			text-align: center;
		}
		div.discojuice {
			text-align: left;
			position: relative;
			width: 600px;
			margin-right: auto;
			margin-left: auto;
		}
	</style>

	
	<script type="text/javascript">


		$("document").ready(function() {

			$.getJSON('/data/acl.json', function(acl) {

				var options = {
					"title": "DiscoJuice",
					"feeds": ["edugain", "kalmar", "feide"]
				};
				var djc = DiscoJuice.Hosted.getConfig(options);

				djc.always = true;
				djc.callback = IdPDiscovery.setup(djc, acl);

				$("body").DiscoJuice(djc);
			});

		});


	</script>
	
	
	
</head>
<body style="background: #e8e8e8">
</body>
</html>
{% endhighlight %}

	<p>The code above will load a JSON file with an ACL list of hostnames from the location <code>/data/acl.json</code>.</p>

	<p>Alternatively, you may configure a list of hosts without any separate JSON request, like this:</p>

{% highlight javascript %}
var acl = ['sp.example.org', 'sp2.example.org'];
var options = {
	"title": "DiscoJuice",
	"feeds": ["edugain", "kalmar", "feide"]
};

var djc = DiscoJuice.Hosted.getConfig(options);
djc.always = true;
djc.callback = IdPDiscovery.setup(djc, acl);

$("body").DiscoJuice(djc);

{% endhighlight %}





	</div>




	<div class="bs-docs-section">
		<div class="page-header">
			<h1 id="deploy-federation">Identity Federation Discovery</h1>
		</div>
		<p class="lead">Setup a preconfigured discovery service for your local federation that implements the IdP Discovery Protocol.</p>


		<p>Setting up a discovery service using DiscoJuice typically involves two main steps:</p>
		<ol>
			<li>Configure an ACL list of hostnames that are allowed to communicate and get respones from the Discovery Service</li>
			<li>Setup the discovery page it self containing static HTML</li>
		</ol>


		<h2>Setting up the HTML Discovery page</h2>

		<p>The page will be presented on a URL of your choice. This URL will be the endpoint where you point the service provider to send IdP Discovery requsts.</p>

		<p>Below is an example of such a page.</p>



{% highlight html %}
<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="utf-8" />
	<title>Select your login provider â€“ DiscoJuice</title>
	
	<script type="text/javascript" 
		src="//ajax.googleapis.com/ajax/libs/jquery/1.10.2/jquery.min.js"></script>

	<script type="text/javascript" language="javascript" 
		src="//cdn.discojuice.org/engine/discojuice-stable.min.js"></script>
	<script type="text/javascript" language="javascript" 
		src="//cdn.discojuice.org/engine/idpdiscovery.js"></script>

	<link rel="stylesheet" type="text/css" 
		href="//cdn.discojuice.org/css/discojuice.css" />



	<style type="text/css">
		body {
			text-align: center;
		}
		div.discojuice {
			text-align: left;
			position: relative;
			width: 600px;
			margin-right: auto;
			margin-left: auto;
		}
	</style>

	
	<script type="text/javascript">

		$("document").ready(function() {

			$.getJSON('/data/acl.json', function(acl) {

				var options = {
					"title": "DiscoJuice",
					"feeds": ["edugain", "kalmar", "feide"]
				};
				var djc = DiscoJuice.Hosted.getConfig(options);

				djc.always = true;
				djc.callback = IdPDiscovery.setup(djc, acl);

				$("body").DiscoJuice(djc);
			});

		});

	</script>
	
	
	
</head>
<body style="background: #e8e8e8">
</body>
</html>
{% endhighlight %}



	</div>





	<div class="bs-docs-section">
		<div class="page-header">
			<h1 id="deploy-global">Global IdP Discovery Service</h1>
		</div>
		<p class="lead">The simplest choice of them all.</p>
		<p>There is a central DiscoJuice discovery page running at</p>

<pre>http://cdn.discojuice.org/discovery</pre>

		<p>This discovery page accepts to return responses to all Service Provieders registered properly in all member metadata feeds.</p>

		<p>You may perform a limited configuration of the Discovery service, that will be part of the URL. You may create a configuration JSON object containing two properties, title and feeds, like this:</p>

<pre>
{
	"title": "Feide Discovery",
	"feeds": ["feide"]
}
</pre>
		
		<p>This configuration object may be JSON encoded, and URLencoded, and added to the query string of the discovery endpoint as a parameter <code>b</code>.

		<p>The resulting URL may be something like:</p>

<pre>https://cdn.discojuice.org/discovery?b=%7B%22title%22%3A%22Feide%20Discovery%22%2C%22feeds%22%3A%5B%22feide%22%5D%7D</pre>


		<p>The <a href="../customize/">customize page</a> will aid you in creating a URL containing a configuration object.</p>



	</div>




