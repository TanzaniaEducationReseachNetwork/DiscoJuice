# Installing DiscoJuice as part of SimpleSAMLphp




## Installing SimpleSAMLphp

Currently the discojuice module is [available only in SimpleSAMLphp trunk](http://simplesamlphp.org/docs/1.7/simplesamlphp-subversion). Make sure you run the latest version of [SimpleSAMLphp](http://simplesamlphp.org/).


## SQLite prerequisite

You need the SQLite extension of PHP. DiscoJuice uses this library for some caching functionality.

On debian it might be installed using:

	aptitude install php5-sqlite

* [PHP Documentation on installing this extension](http://www.php.net/manual/en/sqlite.installation.php)




## Enabling DiscoJuice Module


Enable the discojuice module, and the required dependency modules `sanitycheck`, `cron`:

	touch modules/discojuice/enable
	touch modules/cron/enable
	touch modules/sanitycheck/enable

Then make sure that the cache directory is writable:

	chmod a+rwX data

Copy the configuration templates:

	cp modules/discojuice/config-templates/*.php config/
	cp modules/cron/config-templates/*.php config/
	cp modules/sanitycheck/config-templates/*.php config/


## Verifying your installation

On the federation tab of your SimpleSAMLphp installation you will now see some new links:

* DiscoJuice: Discovery Service (not functional without IdP Discovery parameters)
* DiscoJuice: Metadata Feed (JSON)

First visit the *Metadata Feed* link. The first time, this may take a while to load. It will try to lookup coordinates of all IdPs, as well as some other operations. If it loads successfully, load the same page again with `?refresh=1` parameters to the URL - then it will store the results in cache. This operation will automatically run through the `cron` module, every hour, updating changes and caching the result.

*Note: If this page exceeds max execution time, you may confiugre that in php.ini, or run the metadata update through the cron module.*

Next visit the `Discovery Service` link, and verify that it lists all Identity Providers.

Now, you need to [configure DiscoJuice](simplesamlphp-module-config) to improve the user experience.



